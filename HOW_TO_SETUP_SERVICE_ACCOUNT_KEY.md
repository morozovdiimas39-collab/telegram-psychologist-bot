# –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é setup-database —Å –∫–ª—é—á–æ–º —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞

## –ß—Ç–æ –Ω—É–∂–Ω–æ

–£ —Ç–µ–±—è –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å:
1. **ID –∫–ª—é—á–∞ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞** (–Ω–∞–ø—Ä–∏–º–µ—Ä: `ajeke7hvv73d03siopbo`)
2. **–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á** –≤ —Ñ–æ—Ä–º–∞—Ç–µ PEM (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `-----BEGIN PRIVATE KEY-----`)

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í —Ñ—É–Ω–∫—Ü–∏–∏ `setup-database` –≤ Yandex Cloud Functions –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–≤–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

### 1. YANDEX_SERVICE_ACCOUNT_KEY_ID
**–ó–Ω–∞—á–µ–Ω–∏–µ:** ID –∫–ª—é—á–∞ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞  
**–ü—Ä–∏–º–µ—Ä:** `ajeke7hvv73d03siopbo`

### 2. YANDEX_SERVICE_ACCOUNT_PRIVATE_KEY
**–ó–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª–Ω—ã–π –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –≤ —Ñ–æ—Ä–º–∞—Ç–µ PEM (–≤–∫–ª—é—á–∞—è –∑–∞–≥–æ–ª–æ–≤–∫–∏)

**–í–∞–∂–Ω–æ:** –ö–ª—é—á –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
```
-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC...
(–º–Ω–æ–≥–æ —Å—Ç—Ä–æ–∫ —Å –¥–∞–Ω–Ω—ã–º–∏ –∫–ª—é—á–∞)
...
-----END PRIVATE KEY-----
```

## –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ Yandex Cloud Functions

1. –û—Ç–∫—Ä–æ–π https://console.cloud.yandex.ru/functions
2. –ù–∞–π–¥–∏ —Ñ—É–Ω–∫—Ü–∏—é `setup-database`
3. –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"–†–µ–¥–∞–∫—Ç–æ—Ä"** –∏–ª–∏ **"–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è"**
4. –ù–∞–π–¥–∏ —Ä–∞–∑–¥–µ–ª **"–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è"**
5. –î–æ–±–∞–≤—å –¥–≤–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
   - `YANDEX_SERVICE_ACCOUNT_KEY_ID` = `—Ç–≤–æ–π_ID_–∫–ª—é—á–∞`
   - `YANDEX_SERVICE_ACCOUNT_PRIVATE_KEY` = `—Ç–≤–æ–π_–ø—Ä–∏–≤–∞—Ç–Ω—ã–π_–∫–ª—é—á` (–≤–µ—Å—å –±–ª–æ–∫ —Å BEGIN/END)

## –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

‚ö†Ô∏è **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á ‚Äî —ç—Ç–æ —Å–µ–∫—Ä–µ—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è!
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—É–±–ª–∏–∫—É–π –µ–≥–æ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –¥–æ—Å—Ç—É–ø–µ
- –•—Ä–∞–Ω–∏ –µ–≥–æ —Ç–æ–ª—å–∫–æ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏

‚ö†Ô∏è **–§–æ—Ä–º–∞—Ç –∫–ª—é—á–∞:**
- –ö–ª—é—á –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ PEM
- –í–∫–ª—é—á–∞–π –í–°–ï —Å—Ç—Ä–æ–∫–∏ –æ—Ç `-----BEGIN PRIVATE KEY-----` –¥–æ `-----END PRIVATE KEY-----`
- –ï—Å–ª–∏ –∫–ª—é—á –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É, –¥–æ–±–∞–≤—å –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫ (`\n`)

‚ö†Ô∏è **ID –∫–ª—é—á–∞ vs ID —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞:**
- –í –ø–æ–ª–µ `YANDEX_SERVICE_ACCOUNT_KEY_ID` –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –ª–∏–±–æ ID –∫–ª—é—á–∞, –ª–∏–±–æ ID —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
- –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ID –∫–ª—é—á–∞ (–∫–∞–∫ –≤ —Ç–≤–æ—ë–º —Å–ª—É—á–∞–µ), —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–ø—Ä–æ–±—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ
- –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø–æ–ø—Ä–æ–±—É–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ID —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ (–µ–≥–æ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ Yandex Cloud)

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:

1. **–°–æ–∑–¥–∞–π –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é —Ñ—É–Ω–∫—Ü–∏–∏** (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
2. **–í—ã–∑–æ–≤–∏ —Ñ—É–Ω–∫—Ü–∏—é** —á–µ—Ä–µ–∑ HTTP –∑–∞–ø—Ä–æ—Å –∏–ª–∏ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å
3. **–ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏** ‚Äî –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ "üîê –ü–æ–ª—É—á–∞—é IAM —Ç–æ–∫–µ–Ω..." –∏ "‚úÖ JWT —Ç–æ–∫–µ–Ω —Å–æ–∑–¥–∞–Ω"

## –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –û—à–∏–±–∫–∞: "–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è JWT —Ç–æ–∫–µ–Ω–∞"
- –ü—Ä–æ–≤–µ—Ä—å —Ñ–æ—Ä–º–∞—Ç –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å PEM —Å BEGIN/END)
- –£–±–µ–¥–∏—Å—å, —á—Ç–æ –∫–ª—é—á —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é
- –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ—Ç –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤ –≤ –Ω–∞—á–∞–ª–µ/–∫–æ–Ω—Ü–µ

### –û—à–∏–±–∫–∞: "IAM token error: 401"
- –ü—Ä–æ–≤–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å ID –∫–ª—é—á–∞
- –ü–æ–ø—Ä–æ–±—É–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ID —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ –≤–º–µ—Å—Ç–æ ID –∫–ª—é—á–∞
- –£–±–µ–¥–∏—Å—å, —á—Ç–æ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –∏–º–µ–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–∞–≤–∞

### –û—à–∏–±–∫–∞: "–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ jwt –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞"
- –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –≤ `requirements.txt` —Ñ—É–Ω–∫—Ü–∏–∏ –µ—Å—Ç—å `PyJWT>=2.8.0`
- –°–æ–∑–¥–∞–π –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞

–ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–ª—é—á —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **IAM —Ç–æ–∫–µ–Ω** –∏–∑ –∫–æ–Ω—Å–æ–ª–∏ Yandex Cloud:
1. –û—Ç–∫—Ä–æ–π https://console.cloud.yandex.ru/
2. –í –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É ‚Üí **"–ü–æ–ª—É—á–∏—Ç—å IAM —Ç–æ–∫–µ–Ω"**
3. –°–∫–æ–ø–∏—Ä—É–π —Ç–æ–∫–µ–Ω
4. –î–æ–±–∞–≤—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `YANDEX_CLOUD_TOKEN` = `—Ç–≤–æ–π_IAM_—Ç–æ–∫–µ–Ω`

IAM —Ç–æ–∫–µ–Ω –¥–µ–π—Å—Ç–≤—É–µ—Ç 12 —á–∞—Å–æ–≤, –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—ã–π.
